FROM node:14-alpine as common-build

WORKDIR /app

COPY package.json .

# COPY package-lock.json .

#RUN npm config set proxy http://localhost:3002

RUN npm install

COPY . .

EXPOSE 3002


RUN npm run docker:prod:build



## nginx stage

FROM nginx:alpine

COPY nginx.conf /etc/nginx/conf.d/default.conf

COPY --from=common-build /app/dist /usr/share/nginx/html